{"version":3,"sources":["components/layout/Heading/index.tsx","components/layout/Heading/index.module.scss","logic/contracts/api/masterCopies.ts","routes/safe/components/Settings/SafeDetails/style.ts","logic/safe/utils/upgradeSafe.ts","routes/safe/components/Settings/UpdateSafeModal/style.ts","routes/safe/components/Settings/UpdateSafeModal/index.tsx","routes/safe/components/Settings/SafeDetails/index.tsx"],"names":["cx","classNames","bind","styles","Heading","props","align","children","className","color","margin","tag","testId","truncate","rest","classes","capitalize","undefined","React","module","exports","MasterCopyDeployer","createStyles","formContainer","padding","lg","root","display","maxWidth","saveBtn","fontWeight","boldFont","marginRight","sm","controlsRow","borderTop","border","marginTop","getUpgradeSafeTransactionHash","safeAddress","safeCurrentVersion","safeMasterContractAddress","getSafeMasterContractAddress","updateSafeTxData","getGnosisSafeInstanceAt","methods","changeMasterCopy","encodeABI","fallbackHandlerTxData","hasSetFallbackHandler","semverSatisfies","LATEST_SAFE_VERSION","fallbackHandlerAddress","getFallbackHandlerContractAddress","safeInstance","setFallbackHandler","EMPTY_DATA","getFallbackHandlerTxData","txs","to","value","data","encodeMultiSendCall","useStyles","makeStyles","modalContent","md","UpdateSafeModal","onClose","dispatch","useDispatch","useState","multiSendCallData","setMultiSendCallData","useEffect","encodeMultiSendCallData","TxModalWrapper","txData","txTo","getMultisendContractAddress","operation","Operation","DELEGATE","onSubmit","txParameters","delayExecution","createTransaction","valueInWei","txNonce","safeNonce","safeTxGas","ethParameters","notifiedTransaction","submitText","ModalHeader","title","Block","Row","Paragraph","noMargin","Link","target","extractMasterCopyInfo","mc","isCircles","version","toLowerCase","includes","CIRCLES","dashIndex","indexOf","address","substring","deployer","GNOSIS","deployerRepoUrl","fetchMasterCopies","a","getMasterCopies","GATEWAY_URL","_getChainId","res","map","console","error","SAFE_NAME_INPUT_TEST_ID","SAFE_NAME_SUBMIT_BTN_TEST_ID","SAFE_NAME_UPDATE_SAFE_BTN_TEST_ID","StyledLink","styled","StyledIcon","Icon","StyledParagraph","SafeDetails","isUserOwner","useSelector","grantedSelector","latestMasterContractVersion","latestMasterContractVersionSelector","curChainId","currentChainId","currentSafe","safeNeedsUpdate","needsUpdate","currentVersion","chainId","safeName","safesWithNamesAsMap","name","trackEvent","useAnalytics","isModalOpen","setModalOpen","safeInfo","setSafeInfo","toggleModal","prevOpen","handleUpdateSafe","SETTINGS_EVENTS","DETAILS","getMasterCopyInfo","masterCopies","getMasterCopyAddressFromProxyAddress","masterCopyAddress","masterCopy","find","sameAddress","GnoForm","values","addressBookAddOrUpdate","makeAddressBookEntry","updateSafe","loadedViaUrl","notification","getNotificationsFromTxType","TX_NOTIFICATION_TYPES","SAFE_NAME_CHANGE_TX","enqueueSnackbar","enhanceSnackbarForAction","afterExecution","noMoreConfirmationsNeeded","grow","rel","href","size","as","type","Button","onClick","variant","ChainIndicator","Field","component","TextField","defaultValue","placeholder","text","validate","composeValidators","required","validAddressBookName","Col","end","Modal","description","handleClose","open"],"mappings":"uQAOMA,EAAKC,IAAWC,KAAKC,KAYZC,IAVC,SAACC,GACf,IAAQC,EAAmFD,EAAnFC,MAAOC,EAA4EF,EAA5EE,SAAf,EAA2FF,EAAlEG,iBAAzB,MAAqC,GAArC,EAAyCC,EAAkDJ,EAAlDI,MAAOC,EAA2CL,EAA3CK,OAAQC,EAAmCN,EAAnCM,IAAKC,EAA8BP,EAA9BO,OAAQC,EAAsBR,EAAtBQ,SAAaC,EAAlF,YAA2FT,EAA3F,GAEMU,EAAUf,EAAGQ,EAAW,UAAWF,EAAOK,EAAKD,EAASM,YAAWN,EAAQ,eAAYO,EAAWR,EAAO,CAC7GI,aAGF,OAAOK,gBAAoBP,EAApB,2BAA8BG,GAA9B,IAAoCN,UAAWO,EAAS,cAAeH,GAAU,KAAML,K,qBCfhGY,EAAOC,QAAU,CAAC,QAAU,yBAAyB,GAAK,oBAAoB,GAAK,oBAAoB,GAAK,oBAAoB,GAAK,oBAAoB,OAAS,wBAAwB,MAAQ,uBAAuB,SAAW,0BAA0B,SAAW,0BAA0B,SAAW,0BAA0B,SAAW,0BAA0B,SAAW,0BAA0B,KAAO,sBAAsB,OAAS,wBAAwB,KAAO,sBAAsB,MAAQ,uBAAuB,QAAU,yBAAyB,QAAU,yBAAyB,UAAY,2BAA2B,SAAW,0BAA0B,MAAQ,uBAAuB,MAAQ,yB,uOCIzrBC,E,iGCFClB,EAASmB,YAAa,CACjCC,cAAe,CACbC,QAASC,MAEXC,KAAM,CACJC,QAAS,OACTC,SAAU,SAEZC,QAAS,CACPC,WAAYC,WACZC,YAAaC,MAEfC,YAAa,CACXC,UAAU,aAAD,OAAeC,UACxBZ,QAASC,KACTY,UAAWJ,Q,8NCIFK,EAAgC,SAACC,EAAqBC,GACjE,IAAMC,EAA4BC,cAG5BC,EAFeC,YAAwBL,EAAaC,GAEpBK,QAAQC,iBAAiBL,GAA2BM,YACpFC,EAhByB,SAACT,GAChC,IAAMU,EAAwBC,IAAgBC,IAAqB,WAE7DC,EAAyBC,cACzBC,EAAeV,YAAwBL,EAAaY,KAE1D,OAAOF,EACHK,EAAaT,QAAQU,mBAAmBH,GAAwBL,YAChES,IAQ0BC,CAAyBlB,GACjDmB,EAAM,CACV,CACEC,GAAIpB,EACJqB,MAAO,IACPC,KAAMlB,GAER,CACEgB,GAAIpB,EACJqB,MAAO,IACPC,KAAMb,IAIV,OAAOc,YAAoBJ,I,4BCtChBK,EAAYC,YACvB1C,YAAa,CACX2C,aAAc,CACZzC,QAAQ,GAAD,OAAK0C,KAAL,YAAWzC,U,OCmBX0C,EAAkB,SAAC,GAA6E,IAA3EC,EAA0E,EAA1EA,QAAS7B,EAAiE,EAAjEA,YAAaC,EAAoD,EAApDA,mBAChDzB,EAAUgD,IACVM,EAAWC,cACjB,EAAkDC,mBAASf,KAA3D,mBAAOgB,EAAP,KAA0BC,EAA1B,KAEAC,qBAAU,WACR,IAAMC,EAA0BrC,EAA8BC,EAAaC,GAC3EiC,EAAqBE,KACpB,CAACpC,EAAaC,IAqBjB,OACE,eAACoC,EAAA,EAAD,CACEC,OAAQL,EACRM,KAAMC,cACNC,UAAWC,YAAUC,SACrBC,SAxBiB,SAACC,EAA4BC,GAEhDhB,EACEiB,YAAkB,CAChB/C,cACAoB,GAAIoB,cACJQ,WAAY,IACZV,OAAQL,EACRgB,QAASJ,EAAaK,UACtBC,UAAWN,EAAaM,UACxBC,cAAeP,EACfQ,oBAAqB,cACrBZ,UAAWC,YAAUC,SACrBG,oBAGJjB,KASEA,QAASA,EACTyB,WAAW,cANb,UAQE,cAACC,EAAA,EAAD,CAAa1B,QAASA,EAAS2B,MAAM,wBACrC,cAACC,EAAA,EAAD,CAAOxF,UAAWO,EAAQkD,aAA1B,SACE,eAACgC,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,CAAWC,UAAQ,EAAnB,wGAGA,eAACD,EAAA,EAAD,8FACmF,IACjF,cAACE,EAAA,EAAD,CAAMC,OAAO,SAAS1C,GAAE,iEAA4DR,KAApF,uDAIF,cAAC+C,EAAA,EAAD,CAAWC,UAAQ,EAAnB,yMAMA,eAACD,EAAA,EAAD,WACE,wCADF,8N,qDJ5EE7E,K,gBAAAA,E,mBAAAA,M,KAUZ,I,SAAMiF,GAAwB,SAACC,GAC7B,IAAMC,EAAYD,EAAGE,QAAQC,cAAcC,SAAStF,EAAmBuF,QAAQF,eACzEG,EAAYN,EAAGE,QAAQK,QAAQ,KAUrC,MARmB,CACjBC,QAASR,EAAGQ,QACZN,QAAUD,EAAyBD,EAAGE,QAAQO,UAAU,EAAGH,GAArCN,EAAGE,QACzBQ,SAAWT,EAAwCnF,EAAmBuF,QAA/CvF,EAAmB6F,OAC1CC,gBAAkBX,EAEd,wDADA,sDAMKY,GAAiB,uCAAG,4BAAAC,EAAA,+EAEXC,0BAAgBC,IAAaC,eAFlB,cAEvBC,EAFuB,yBAGtBA,EAAIC,IAAIpB,KAHc,gCAK7BqB,QAAQC,MAAM,2CAAd,MAL6B,yDAAH,qD,mBKUjBC,GAA0B,kBAC1BC,GAA+B,uBAC/BC,GAAoC,uBAE3ChE,GAAYC,YAAW7D,GAEvB6H,GAAaC,kBAAO7B,OAAP6B,CAAH,qDAGVC,GAAaD,kBAAOE,OAAPF,CAAH,gFAKVG,GAAkBH,kBAAO/B,IAAP+B,CAAH,mDAqKNI,UAjKK,WAAqB,IAAD,EAChCtH,EAAUgD,KACVuE,EAAcC,YAAYC,KAC1BC,EAA8BF,YAAYG,KAC1CC,EAAaJ,YAAYK,MAC/B,EAKIL,YAAYM,KAJLtG,EADX,EACEwE,QACa+B,EAFf,EAEEC,YACgBvG,EAHlB,EAGEwG,eAHF,IAIEC,eAJF,MAIYN,EAJZ,EAOMO,EAAQ,UADOX,YAAYY,KACH5G,UAAhB,aAAG,EAA2B6G,KAEtC/E,EAAWC,cACT+E,EAAeC,cAAfD,WAER,EAAoC9E,oBAAS,GAA7C,mBAAOgF,EAAP,KAAoBC,EAApB,KACA,EAAgCjF,qBAAhC,mBAAOkF,EAAP,KAAiBC,EAAjB,KAEMC,EAAc,WAClBH,GAAa,SAACI,GAAD,OAAeA,MAgBxBC,GAAmB,WACvBL,GAAa,IAsCf,OAjBA9E,qBAAU,WACR2E,EAAWS,IAAgBC,WAC1B,CAACV,IAEJ3E,qBAAU,WACR,IAAMsF,EAAiB,uCAAG,gCAAA3C,EAAA,sEACGD,KADH,cAClB6C,EADkB,gBAEQC,YAAqC3H,GAF7C,OAElB4H,EAFkB,OAGlBC,EAHkB,OAGLH,QAHK,IAGLA,OAHK,EAGLA,EAAcI,MAAK,SAAC9D,GAAD,OAAQ+D,YAAY/D,EAAGQ,QAASoD,MACtET,EAAYU,GAJY,2CAAH,qDAOnB7H,GACFyH,MAED,CAACzH,IAGF,cAACgI,EAAA,EAAD,CAASpF,SArDU,SAACqF,GACpBnG,EACEoG,YACEC,YAAqB,CAAE3D,QAASxE,EAAa6G,KAAMoB,EAAOtB,SAAUD,QAASN,MAIjFtE,EAASsG,YAAW,CAAE5D,QAASxE,EAAaqI,cAAc,KAE1D,IAAMC,EAAeC,YAA2BC,IAAsBC,qBACtE3G,EAAS4G,YAAgBC,YAAyBL,EAAaM,eAAeC,8BA2C9E,SACG,kBACC,qCACE,eAACpF,EAAA,EAAD,CAAOxF,UAAWO,EAAQQ,cAA1B,UACE,cAACnB,EAAA,EAAD,CAASO,IAAI,KAAb,8BACA,cAACsF,EAAA,EAAD,CAAK3F,MAAM,MAAM+K,MAAI,EAArB,SACE,eAACrD,GAAD,CAAYsD,IAAI,sBAAsBjF,OAAO,SAASkF,KAAI,OAAE9B,QAAF,IAAEA,OAAF,EAAEA,EAAUtC,gBAAtE,UACE,eAAC,OAAD,CAAMqE,KAAK,KAAKC,GAAG,OAAOhL,MAAM,UAAhC,UA1CPgJ,EAGEA,EAASxC,WAAa5F,EAAmB6F,OAC5C1E,EADG,UAEAA,EAFA,YAEsBiH,EAASxC,UAJ7B,GAQJwC,GAGEA,EAASxC,WAAa5F,EAAmB6F,QAAU4B,EAAnD,qCAC2BL,EAD3B,KAFE,MAoCG,cAACP,GAAD,CAAYsD,KAAK,KAAKE,KAAK,eAAejL,MAAM,iBAGnDqI,GAAmBR,EAClB,cAACrC,EAAA,EAAD,CAAK3F,MAAM,MAAM+K,MAAI,EAArB,SACE,cAACnF,EAAA,EAAD,UACE,cAACyF,EAAA,EAAD,CACEnL,UAAWO,EAAQc,QACnBpB,MAAM,UACNmL,QAAS/B,GACT2B,KAAK,QACL5K,OAAQmH,GACR8D,QAAQ,YANV,6BAYF,QAGN,eAAC7F,EAAA,EAAD,CAAOxF,UAAWO,EAAQQ,cAA1B,UACE,cAACnB,EAAA,EAAD,CAASO,IAAI,KAAb,gCACA,cAACyH,GAAD,UACE,cAAC0D,GAAA,EAAD,CAAgB7C,QAASA,SAIhB,MAAZC,GACC,eAAClD,EAAA,EAAD,CAAOxF,UAAWO,EAAQQ,cAA1B,UACE,cAACnB,EAAA,EAAD,CAASO,IAAI,KAAb,8BACA,cAACuF,EAAA,EAAD,wIAIA,cAACF,EAAA,EAAD,CAAOxF,UAAWO,EAAQW,KAA1B,SACE,cAACqK,EAAA,EAAD,CACEC,UAAWC,IACXC,aAAchD,EACdE,KAAK,WACL+C,YAAY,aACZvL,OAAQiH,GACRuE,KAAK,aACLV,KAAK,OACLW,SAAUC,YAAkBC,IAAUC,YAM9C,cAACvG,EAAA,EAAD,CAAK3F,MAAM,MAAME,UAAWO,EAAQmB,YAAamJ,MAAI,EAArD,SACE,cAACoB,EAAA,EAAD,CAAKC,IAAI,KAAT,SACE,cAACf,EAAA,EAAD,CACEnL,UAAWO,EAAQc,QACnBpB,MAAM,UACN+K,KAAK,QACL5K,OAAQkH,GACR4D,KAAK,SACLG,QAAQ,YANV,sBAYJ,cAACc,EAAA,EAAD,CAAOC,YAAY,cAAcC,YAAalD,EAAamD,KAAMvD,EAAaxD,MAAM,cAApF,SACE,cAAC,EAAD,CAAiB3B,QAASuF,EAAapH,YAAaA,EAAaC,mBAAoBA","file":"static/js/68.584cb674.chunk.js","sourcesContent":["import classNames from 'classnames/bind'\nimport * as React from 'react'\n\nimport styles from './index.module.scss'\n\nimport { capitalize } from 'src/utils/css'\n\nconst cx = classNames.bind(styles)\n\nconst Heading = (props) => {\n  const { align, children, className = '', color, margin, tag, testId, truncate, ...rest } = props\n\n  const classes = cx(className, 'heading', align, tag, margin ? capitalize(margin, 'margin') : undefined, color, {\n    truncate,\n  })\n\n  return React.createElement(tag, { ...rest, className: classes, 'data-testid': testId || '' }, children)\n}\n\nexport default Heading\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"Heading_heading__3Wz9P\",\"h1\":\"Heading_h1__MXfCA\",\"h2\":\"Heading_h2__3X6Ts\",\"h3\":\"Heading_h3__1k2fD\",\"h4\":\"Heading_h4__1YCmR\",\"center\":\"Heading_center__28MHY\",\"right\":\"Heading_right__1fQM1\",\"truncate\":\"Heading_truncate__2Lq93\",\"marginSm\":\"Heading_marginSm__13YwX\",\"marginMd\":\"Heading_marginMd__2AnZN\",\"marginLg\":\"Heading_marginLg__2ZfEq\",\"marginXl\":\"Heading_marginXl__3RHt7\",\"soft\":\"Heading_soft__2Zu43\",\"medium\":\"Heading_medium__2X8Z-\",\"dark\":\"Heading_dark__Ds2QB\",\"fancy\":\"Heading_fancy__1Wx6l\",\"warning\":\"Heading_warning__2lrZC\",\"primary\":\"Heading_primary__2hOk2\",\"secondary\":\"Heading_secondary__37lKs\",\"disabled\":\"Heading_disabled__30DjG\",\"error\":\"Heading_error__t5ujr\",\"white\":\"Heading_white__2gkIK\"};","import { MasterCopyReponse, getMasterCopies } from '@gnosis.pm/safe-react-gateway-sdk'\n\nimport { _getChainId } from 'src/config'\nimport { GATEWAY_URL } from 'src/utils/constants'\n\nexport enum MasterCopyDeployer {\n  GNOSIS = 'Gnosis',\n  CIRCLES = 'Circles',\n}\n\nexport type MasterCopy = MasterCopyReponse[number] & {\n  deployer: MasterCopyDeployer\n  deployerRepoUrl: string\n}\n\nconst extractMasterCopyInfo = (mc: MasterCopyReponse[number]): MasterCopy => {\n  const isCircles = mc.version.toLowerCase().includes(MasterCopyDeployer.CIRCLES.toLowerCase())\n  const dashIndex = mc.version.indexOf('-')\n\n  const masterCopy = {\n    address: mc.address,\n    version: !isCircles ? mc.version : mc.version.substring(0, dashIndex),\n    deployer: !isCircles ? MasterCopyDeployer.GNOSIS : MasterCopyDeployer.CIRCLES,\n    deployerRepoUrl: !isCircles\n      ? 'https://github.com/gnosis/safe-contracts/releases'\n      : 'https://github.com/CirclesUBI/safe-contracts/releases',\n  }\n  return masterCopy\n}\n\nexport const fetchMasterCopies = async (): Promise<MasterCopy[] | undefined> => {\n  try {\n    const res = await getMasterCopies(GATEWAY_URL, _getChainId())\n    return res.map(extractMasterCopyInfo)\n  } catch (error) {\n    console.error('Fetching data from master-copies errored', error)\n  }\n}\n","import { createStyles } from '@material-ui/core/styles'\nimport { boldFont, border, lg, sm } from 'src/theme/variables'\n\nexport const styles = createStyles({\n  formContainer: {\n    padding: lg,\n  },\n  root: {\n    display: 'flex',\n    maxWidth: '480px',\n  },\n  saveBtn: {\n    fontWeight: boldFont,\n    marginRight: sm,\n  },\n  controlsRow: {\n    borderTop: `2px solid ${border}`,\n    padding: lg,\n    marginTop: sm,\n  },\n})\n","import semverSatisfies from 'semver/functions/satisfies'\n\nimport { LATEST_SAFE_VERSION } from 'src/utils/constants'\nimport {\n  getGnosisSafeInstanceAt,\n  getSafeMasterContractAddress,\n  getFallbackHandlerContractAddress,\n} from 'src/logic/contracts/safeContracts'\nimport { encodeMultiSendCall } from 'src/logic/safe/transactions/multisend'\nimport { EMPTY_DATA } from 'src/logic/wallets/ethTransactions'\n\nconst getFallbackHandlerTxData = (safeAddress: string): string => {\n  const hasSetFallbackHandler = semverSatisfies(LATEST_SAFE_VERSION, '>=1.1.0')\n\n  const fallbackHandlerAddress = getFallbackHandlerContractAddress()\n  const safeInstance = getGnosisSafeInstanceAt(safeAddress, LATEST_SAFE_VERSION)\n\n  return hasSetFallbackHandler\n    ? safeInstance.methods.setFallbackHandler(fallbackHandlerAddress).encodeABI()\n    : EMPTY_DATA\n}\n\nexport const getUpgradeSafeTransactionHash = (safeAddress: string, safeCurrentVersion: string): string => {\n  const safeMasterContractAddress = getSafeMasterContractAddress()\n  const safeInstance = getGnosisSafeInstanceAt(safeAddress, safeCurrentVersion)\n  // @ts-expect-error this was removed in 1.3.0 but we need to support it for older safe versions\n  const updateSafeTxData = safeInstance.methods.changeMasterCopy(safeMasterContractAddress).encodeABI()\n  const fallbackHandlerTxData = getFallbackHandlerTxData(safeAddress)\n  const txs = [\n    {\n      to: safeAddress,\n      value: '0',\n      data: updateSafeTxData,\n    },\n    {\n      to: safeAddress,\n      value: '0',\n      data: fallbackHandlerTxData,\n    },\n  ]\n\n  return encodeMultiSendCall(txs)\n}\n","import { lg, md } from 'src/theme/variables'\nimport { createStyles, makeStyles } from '@material-ui/core'\n\nexport const useStyles = makeStyles(\n  createStyles({\n    modalContent: {\n      padding: `${md} ${lg}`,\n    },\n  }),\n)\n","import { Operation } from '@gnosis.pm/safe-react-gateway-sdk'\nimport { useEffect, useState } from 'react'\nimport { useDispatch } from 'react-redux'\n\nimport { LATEST_SAFE_VERSION } from 'src/utils/constants'\nimport Link from 'src/components/layout/Link'\nimport Block from 'src/components/layout/Block'\nimport Paragraph from 'src/components/layout/Paragraph'\nimport Row from 'src/components/layout/Row'\nimport { getUpgradeSafeTransactionHash } from 'src/logic/safe/utils/upgradeSafe'\nimport { createTransaction } from 'src/logic/safe/store/actions/createTransaction'\nimport { getMultisendContractAddress } from 'src/logic/contracts/safeContracts'\nimport { EMPTY_DATA } from 'src/logic/wallets/ethTransactions'\nimport { TxParameters } from 'src/routes/safe/container/hooks/useTransactionParameters'\nimport { ModalHeader } from 'src/routes/safe/components/Balances/SendModal/screens/ModalHeader'\nimport { TxModalWrapper } from 'src/routes/safe/components/Transactions/helpers/TxModalWrapper'\n\nimport { useStyles } from './style'\n\ntype Props = {\n  onClose: () => void\n  safeAddress: string\n  safeCurrentVersion: string\n}\n\nexport const UpdateSafeModal = ({ onClose, safeAddress, safeCurrentVersion }: Props): React.ReactElement => {\n  const classes = useStyles()\n  const dispatch = useDispatch()\n  const [multiSendCallData, setMultiSendCallData] = useState(EMPTY_DATA)\n\n  useEffect(() => {\n    const encodeMultiSendCallData = getUpgradeSafeTransactionHash(safeAddress, safeCurrentVersion)\n    setMultiSendCallData(encodeMultiSendCallData)\n  }, [safeAddress, safeCurrentVersion])\n\n  const handleSubmit = (txParameters: TxParameters, delayExecution: boolean) => {\n    // Call the update safe method\n    dispatch(\n      createTransaction({\n        safeAddress,\n        to: getMultisendContractAddress(),\n        valueInWei: '0',\n        txData: multiSendCallData,\n        txNonce: txParameters.safeNonce,\n        safeTxGas: txParameters.safeTxGas,\n        ethParameters: txParameters,\n        notifiedTransaction: 'STANDARD_TX',\n        operation: Operation.DELEGATE,\n        delayExecution,\n      }),\n    )\n    onClose()\n  }\n\n  return (\n    <TxModalWrapper\n      txData={multiSendCallData}\n      txTo={getMultisendContractAddress()}\n      operation={Operation.DELEGATE}\n      onSubmit={handleSubmit}\n      onClose={onClose}\n      submitText=\"Update Safe\"\n    >\n      <ModalHeader onClose={onClose} title=\"Update safe version\" />\n      <Block className={classes.modalContent}>\n        <Row>\n          <Paragraph noMargin>\n            Update now to take advantage of new features and the highest security standards available.\n          </Paragraph>\n          <Paragraph>\n            To check details about updates added by this smart contract version please visit{' '}\n            <Link target=\"_blank\" to={`https://github.com/gnosis/safe-contracts/releases/tag/v${LATEST_SAFE_VERSION}`}>\n              latest Gnosis Safe contracts changelog\n            </Link>\n          </Paragraph>\n          <Paragraph noMargin>\n            You will need to confirm this update just like any other transaction. This means other owners will have to\n            confirm the update in case more than one confirmation is required for this Safe.\n          </Paragraph>\n\n          {/* A warning for 1.x.x -> 1.3.0 upgrades */}\n          <Paragraph>\n            <b>Warning</b>: this upgrade will invalidate all unexecuted transactions. This means you will be unable to\n            access or execute them after the upgrade. Please make sure to execute any remaining transactions before\n            upgrading.\n          </Paragraph>\n        </Row>\n      </Block>\n    </TxModalWrapper>\n  )\n}\n","import { Icon, Link, Text } from '@gnosis.pm/safe-react-components'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ReactElement, useEffect, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled from 'styled-components'\n\nimport { styles } from './style'\n\nimport Modal from 'src/components/Modal'\nimport Field from 'src/components/forms/Field'\nimport GnoForm from 'src/components/forms/GnoForm'\nimport TextField from 'src/components/forms/TextField'\nimport { composeValidators, required, validAddressBookName } from 'src/components/forms/validator'\nimport Block from 'src/components/layout/Block'\nimport Button from 'src/components/layout/Button'\nimport Col from 'src/components/layout/Col'\nimport Heading from 'src/components/layout/Heading'\nimport Paragraph from 'src/components/layout/Paragraph'\nimport Row from 'src/components/layout/Row'\nimport { makeAddressBookEntry } from 'src/logic/addressBook/model/addressBook'\nimport { addressBookAddOrUpdate } from 'src/logic/addressBook/store/actions'\nimport enqueueSnackbar from 'src/logic/notifications/store/actions/enqueueSnackbar'\nimport { getNotificationsFromTxType, enhanceSnackbarForAction } from 'src/logic/notifications'\nimport { sameAddress } from 'src/logic/wallets/ethAddresses'\nimport { TX_NOTIFICATION_TYPES } from 'src/logic/safe/transactions'\nimport { UpdateSafeModal } from 'src/routes/safe/components/Settings/UpdateSafeModal'\nimport { grantedSelector } from 'src/routes/safe/container/selector'\nimport { updateSafe } from 'src/logic/safe/store/actions/updateSafe'\n\nimport {\n  currentSafe,\n  latestMasterContractVersion as latestMasterContractVersionSelector,\n  safesWithNamesAsMap,\n} from 'src/logic/safe/store/selectors'\nimport { useAnalytics, SETTINGS_EVENTS } from 'src/utils/googleAnalytics'\nimport { fetchMasterCopies, MasterCopy, MasterCopyDeployer } from 'src/logic/contracts/api/masterCopies'\nimport { getMasterCopyAddressFromProxyAddress } from 'src/logic/contracts/safeContracts'\nimport ChainIndicator from 'src/components/ChainIndicator'\nimport { currentChainId } from 'src/logic/config/store/selectors'\n\nexport const SAFE_NAME_INPUT_TEST_ID = 'safe-name-input'\nexport const SAFE_NAME_SUBMIT_BTN_TEST_ID = 'change-safe-name-btn'\nexport const SAFE_NAME_UPDATE_SAFE_BTN_TEST_ID = 'update-safe-name-btn'\n\nconst useStyles = makeStyles(styles)\n\nconst StyledLink = styled(Link)`\n  margin: 12px 0 0 0;\n`\nconst StyledIcon = styled(Icon)`\n  position: relative;\n  top: 3px;\n  left: 6px;\n`\nconst StyledParagraph = styled(Paragraph)`\n  margin-bottom: 0;\n`\n\nconst SafeDetails = (): ReactElement => {\n  const classes = useStyles()\n  const isUserOwner = useSelector(grantedSelector)\n  const latestMasterContractVersion = useSelector(latestMasterContractVersionSelector)\n  const curChainId = useSelector(currentChainId)\n  const {\n    address: safeAddress,\n    needsUpdate: safeNeedsUpdate,\n    currentVersion: safeCurrentVersion,\n    chainId = curChainId,\n  } = useSelector(currentSafe)\n  const safeNamesMap = useSelector(safesWithNamesAsMap)\n  const safeName = safeNamesMap[safeAddress]?.name\n\n  const dispatch = useDispatch()\n  const { trackEvent } = useAnalytics()\n\n  const [isModalOpen, setModalOpen] = useState(false)\n  const [safeInfo, setSafeInfo] = useState<MasterCopy | undefined>()\n\n  const toggleModal = () => {\n    setModalOpen((prevOpen) => !prevOpen)\n  }\n\n  const handleSubmit = (values) => {\n    dispatch(\n      addressBookAddOrUpdate(\n        makeAddressBookEntry({ address: safeAddress, name: values.safeName, chainId: curChainId }),\n      ),\n    )\n    // setting `loadedViaUrl` to `false` as setting a safe's name is considered to intentionally add the safe\n    dispatch(updateSafe({ address: safeAddress, loadedViaUrl: false }))\n\n    const notification = getNotificationsFromTxType(TX_NOTIFICATION_TYPES.SAFE_NAME_CHANGE_TX)\n    dispatch(enqueueSnackbar(enhanceSnackbarForAction(notification.afterExecution.noMoreConfirmationsNeeded)))\n  }\n\n  const handleUpdateSafe = () => {\n    setModalOpen(true)\n  }\n\n  const getSafeVersion = () => {\n    if (!safeInfo) {\n      return ''\n    }\n    return safeInfo.deployer === MasterCopyDeployer.GNOSIS\n      ? safeCurrentVersion\n      : `${safeCurrentVersion}-${safeInfo.deployer}`\n  }\n\n  const getSafeVersionUpdate = () => {\n    if (!safeInfo) {\n      return ''\n    }\n    return safeInfo.deployer === MasterCopyDeployer.GNOSIS && safeNeedsUpdate\n      ? ` (there's a newer version: ${latestMasterContractVersion})`\n      : ''\n  }\n\n  useEffect(() => {\n    trackEvent(SETTINGS_EVENTS.DETAILS)\n  }, [trackEvent])\n\n  useEffect(() => {\n    const getMasterCopyInfo = async () => {\n      const masterCopies = await fetchMasterCopies()\n      const masterCopyAddress = await getMasterCopyAddressFromProxyAddress(safeAddress)\n      const masterCopy = masterCopies?.find((mc) => sameAddress(mc.address, masterCopyAddress))\n      setSafeInfo(masterCopy)\n    }\n\n    if (safeAddress) {\n      getMasterCopyInfo()\n    }\n  }, [safeAddress])\n\n  return (\n    <GnoForm onSubmit={handleSubmit}>\n      {() => (\n        <>\n          <Block className={classes.formContainer}>\n            <Heading tag=\"h2\">Contract Version</Heading>\n            <Row align=\"end\" grow>\n              <StyledLink rel=\"noreferrer noopener\" target=\"_blank\" href={safeInfo?.deployerRepoUrl}>\n                <Text size=\"xl\" as=\"span\" color=\"primary\">\n                  {getSafeVersion()}\n                  {getSafeVersionUpdate()}\n                </Text>\n                <StyledIcon size=\"sm\" type=\"externalLink\" color=\"primary\" />\n              </StyledLink>\n            </Row>\n            {safeNeedsUpdate && isUserOwner ? (\n              <Row align=\"end\" grow>\n                <Paragraph>\n                  <Button\n                    className={classes.saveBtn}\n                    color=\"primary\"\n                    onClick={handleUpdateSafe}\n                    size=\"small\"\n                    testId={SAFE_NAME_UPDATE_SAFE_BTN_TEST_ID}\n                    variant=\"contained\"\n                  >\n                    Update Safe\n                  </Button>\n                </Paragraph>\n              </Row>\n            ) : null}\n          </Block>\n\n          <Block className={classes.formContainer}>\n            <Heading tag=\"h2\">Blockchain Network</Heading>\n            <StyledParagraph>\n              <ChainIndicator chainId={chainId} />\n            </StyledParagraph>\n          </Block>\n\n          {safeName != null && (\n            <Block className={classes.formContainer}>\n              <Heading tag=\"h2\">Modify Safe Name</Heading>\n              <Paragraph>\n                You can change the name of this Safe. This name is only stored locally and never shared with Gnosis or\n                any third parties.\n              </Paragraph>\n              <Block className={classes.root}>\n                <Field\n                  component={TextField}\n                  defaultValue={safeName}\n                  name=\"safeName\"\n                  placeholder=\"Safe name*\"\n                  testId={SAFE_NAME_INPUT_TEST_ID}\n                  text=\"Safe name*\"\n                  type=\"text\"\n                  validate={composeValidators(required, validAddressBookName)}\n                />\n              </Block>\n            </Block>\n          )}\n\n          <Row align=\"end\" className={classes.controlsRow} grow>\n            <Col end=\"xs\">\n              <Button\n                className={classes.saveBtn}\n                color=\"primary\"\n                size=\"small\"\n                testId={SAFE_NAME_SUBMIT_BTN_TEST_ID}\n                type=\"submit\"\n                variant=\"contained\"\n              >\n                Save\n              </Button>\n            </Col>\n          </Row>\n          <Modal description=\"Update Safe\" handleClose={toggleModal} open={isModalOpen} title=\"Update Safe\">\n            <UpdateSafeModal onClose={toggleModal} safeAddress={safeAddress} safeCurrentVersion={safeCurrentVersion} />\n          </Modal>\n        </>\n      )}\n    </GnoForm>\n  )\n}\n\nexport default SafeDetails\n"],"sourceRoot":""}